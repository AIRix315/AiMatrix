# CLAUDE.md

æœ¬æ–‡ä»¶ä¸º Claude Code (claude.ai/code) åœ¨æ­¤ä»£ç ä»“åº“ä¸­å·¥ä½œæ—¶æä¾›æŒ‡å¯¼ã€‚

## ğŸ”´ é¦–è¦è§„åˆ™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

**å…¨ç¨‹ä½¿ç”¨ä¸­æ–‡å¯¹è¯**
- ä¸ç”¨æˆ·äº¤æµæ—¶å¿…é¡»ä½¿ç”¨ä¸­æ–‡
- æ‰€æœ‰å›å¤ã€è¯´æ˜ã€æ³¨é‡Šéƒ½ä½¿ç”¨ä¸­æ–‡
- ä»£ç æ³¨é‡Šä¼˜å…ˆä½¿ç”¨ä¸­æ–‡
- ä»…åœ¨ä»£ç æ ‡è¯†ç¬¦ï¼ˆå˜é‡åã€å‡½æ•°åç­‰ï¼‰ä¸­ä½¿ç”¨è‹±æ–‡

---

## é¡¹ç›®æ¦‚è¿°

MATRIX Studio æ˜¯ä¸€ä¸ªåŸºäº Electron çš„ AI è§†é¢‘ç”Ÿæˆå·¥ä½œæµç®¡ç†å¹³å°ã€‚ä½œä¸ºä¸­é—´ä»¶ï¼Œæä¾›ç»Ÿä¸€çš„å·¥ä½œæµå’Œç‰©æ–™ç®¡ç†åŠŸèƒ½ï¼Œä¸ç›´æ¥å‚ä¸è§†é¢‘æ¸²æŸ“ã€‚

- **å½“å‰ç‰ˆæœ¬**: v0.2.0
- **æŠ€æœ¯æ ˆ**: Electron 39+, React 18, TypeScript 5, Webpack 5
- **æ¶æ„**: ä¸‰è¿›ç¨‹æ¨¡å‹ï¼ˆä¸»è¿›ç¨‹ã€é¢„åŠ è½½ã€æ¸²æŸ“è¿›ç¨‹ï¼‰

## å¸¸ç”¨å‘½ä»¤

### å¼€å‘æ¨¡å¼
- `npm run dev`: å¯åŠ¨å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ‰€æœ‰è¿›ç¨‹ï¼Œå¯åŠ¨ Electronï¼‰
- `npm run dev:main`: ä»…ç›‘å¬ä¸»è¿›ç¨‹
- `npm run dev:renderer`: ä»…ç›‘å¬æ¸²æŸ“è¿›ç¨‹
- `npm run dev:preload`: ä»…ç›‘å¬é¢„åŠ è½½è„šæœ¬

### æ„å»º
- `npm run build`: æ„å»ºæ‰€æœ‰è¿›ç¨‹ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- `npm run build:main`: ä»…æ„å»ºä¸»è¿›ç¨‹
- `npm run build:renderer`: ä»…æ„å»ºæ¸²æŸ“è¿›ç¨‹
- `npm run build:preload`: ä»…æ„å»ºé¢„åŠ è½½è„šæœ¬

### æµ‹è¯•
- `npm test`: è¿è¡Œæ‰€æœ‰æµ‹è¯•
- `npm run test:unit`: ä»…è¿è¡Œå•å…ƒæµ‹è¯•
- `npm run test:integration`: ä»…è¿è¡Œé›†æˆæµ‹è¯•
- `npm run test:e2e`: ä»…è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
- `jest tests/path/to/specific.test.ts`: è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶

### ä»£ç æ£€æŸ¥ä¸æ ¼å¼åŒ–
- `npm run lint`: æ£€æŸ¥ä»£ç é—®é¢˜
- `npm run lint:fix`: è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜
- `npm run format`: ä½¿ç”¨ Prettier æ ¼å¼åŒ–ä»£ç 

### æ‰“åŒ…
- `npm run package`: ä¸ºå½“å‰å¹³å°æ‰“åŒ…
- `npm run package:win`: ä¸º Windows æ‰“åŒ…
- `npm run package:mac`: ä¸º macOS æ‰“åŒ…
- `npm run package:linux`: ä¸º Linux æ‰“åŒ…

### å·¥å…·å‘½ä»¤
- `npm run clean`: åˆ é™¤ build å’Œ dist ç›®å½•

## æ¶æ„è®¾è®¡

### Electron ä¸‰è¿›ç¨‹æ¨¡å‹

1. **ä¸»è¿›ç¨‹** (`src/main/`): Node.js ç¯å¢ƒï¼Œç®¡ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸã€çª—å£å’Œç³»ç»Ÿé›†æˆ
   - å…¥å£: `src/main/index.ts`
   - æ ¸å¿ƒæœåŠ¡: ProjectManagerã€AssetManagerã€TimeService
   - IPC å¤„ç†å™¨: å¤„ç†æ‰€æœ‰æ¸²æŸ“è¿›ç¨‹çš„è¯·æ±‚

2. **é¢„åŠ è½½è„šæœ¬** (`src/preload/`): ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹ä¹‹é—´çš„æ¡¥æ¢ï¼Œä½¿ç”¨ contextBridge
   - å…¥å£: `src/preload/index.ts`
   - å‘æ¸²æŸ“è¿›ç¨‹æš´éœ² `window.electronAPI`
   - å®‰å…¨å±‚ï¼Œç¡®ä¿ IPC é€šä¿¡å®‰å…¨

3. **æ¸²æŸ“è¿›ç¨‹** (`src/renderer/`): æµè§ˆå™¨ç¯å¢ƒï¼Œè¿è¡Œ React
   - å…¥å£: `src/renderer/index.tsx`
   - è·¯ç”±: React Routerï¼Œä½¿ç”¨ Layout åŒ…è£…å™¨
   - é¡µé¢: Dashboardã€Assetsã€Pluginsã€Workflowsã€Settingsã€About

### æœåŠ¡æ¶æ„

ä¸»è¿›ç¨‹æœåŠ¡éµå¾ªç®¡ç†å™¨æ¨¡å¼ï¼š
- **ProjectManager**: é¡¹ç›®çš„ CRUD æ“ä½œå’Œç”Ÿå‘½å‘¨æœŸç®¡ç† âœ… å®Œæ•´å®ç°
- **AssetManager**: ç‰©æ–™ç®¡ç†ï¼ŒåŸºäºä½œç”¨åŸŸç»„ç»‡ï¼ˆå…¨å±€/é¡¹ç›®ï¼‰ âœ… å®Œæ•´å®ç°
- **TimeService**: é›†ä¸­å¼æ—¶é—´å¤„ç†ï¼ˆNTPåŒæ­¥ã€æ—¶é—´éªŒè¯ï¼‰ âœ… å®Œæ•´å®ç°
- **Logger**: ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿï¼ˆ4çº§æ—¥å¿—ã€æ–‡ä»¶è½®è½¬ï¼‰ âœ… å®Œæ•´å®ç°
- **ServiceErrorHandler**: ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼ˆ37ä¸ªé”™è¯¯ç ï¼‰ âœ… å®Œæ•´å®ç°
- **PluginManager**: æ’ä»¶åŠ è½½/å¸è½½/æ‰§è¡Œ ğŸŸ¡ MVPå®ç°ï¼ˆç¼ºå°‘æ²™ç®±å’Œç­¾åéªŒè¯ï¼‰
- **TaskScheduler**: ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œ ğŸŸ¡ MVPå®ç°ï¼ˆç¼ºå°‘æŒä¹…åŒ–å’Œæˆæœ¬ä¼°ç®—ï¼‰
- **APIManager**: APIæ³¨å†Œå’Œè°ƒç”¨ç®¡ç† ğŸŸ¡ MVPå®ç°ï¼ˆç¼ºå°‘ä½¿ç”¨é‡è·Ÿè¸ªï¼‰

### IPC é€šä¿¡

æ‰€æœ‰ IPC é€šé“éµå¾ªå‘½åçº¦å®š: `ç±»åˆ«:æ“ä½œ` (ä¾‹å¦‚: `project:create`, `window:maximize`)

é€šé“åˆ†ç±»ï¼š
- `app:*`: åº”ç”¨ç”Ÿå‘½å‘¨æœŸï¼ˆç‰ˆæœ¬ã€é€€å‡ºã€é‡å¯ï¼‰
- `window:*`: çª—å£æ§åˆ¶ï¼ˆæœ€å°åŒ–ã€æœ€å¤§åŒ–ã€å…³é—­ï¼‰
- `project:*`: é¡¹ç›®æ“ä½œï¼ˆåˆ›å»ºã€åŠ è½½ã€ä¿å­˜ã€åˆ é™¤ã€åˆ—è¡¨ï¼‰
- `asset:*`: ç‰©æ–™æ“ä½œï¼ˆæ·»åŠ ã€ç§»é™¤ã€æ›´æ–°ã€æœç´¢ã€é¢„è§ˆï¼‰
- `workflow:*`: å·¥ä½œæµæ‰§è¡Œå’Œç®¡ç†
- `plugin:*`: æ’ä»¶å®‰è£…å’Œç®¡ç†
- `task:*`: ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œ
- `api:*`: å¤–éƒ¨ API é›†æˆ
- `file:*`: æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- `mcp:*`: MCP æœåŠ¡é›†æˆ
- `local:*`: æœ¬åœ°æœåŠ¡ç®¡ç†

## å…³é”®è¦æ±‚

### æ—¶é—´å¤„ç†
**é‡è¦**: å†™å…¥ä»»ä½•æ—¶é—´æˆ³æˆ–æ—¶é—´ç›¸å…³æ•°æ®å‰ï¼š
1. ä½¿ç”¨ TimeService æˆ– MCP æœåŠ¡æŸ¥è¯¢ç³»ç»Ÿæ—¶é—´
2. ä½¿ç”¨æŸ¥è¯¢åˆ°çš„æ—¶é—´è¿›è¡Œæ‰€æœ‰æ“ä½œ
3. ç¦æ­¢ç›´æ¥ä½¿ç”¨ `Date.now()` æˆ– `new Date()` è€Œä¸ç»è¿‡éªŒè¯

å‚è€ƒ: `docs/02-technical-blueprint-v1.0.0.md`

### ä»£ç é£æ ¼

**æ¨¡å—å¯¼å…¥**:
```typescript
// âœ… æ­£ç¡® - ä½¿ç”¨ ES æ¨¡å—å’Œè§£æ„å¯¼å…¥
import { app, BrowserWindow, ipcMain } from 'electron';
import { useState, useEffect } from 'react';

// âŒ é”™è¯¯ - ä¸è¦ä½¿ç”¨é»˜è®¤å¯¼å…¥æˆ– CommonJS
import electron from 'electron';
const electron = require('electron');
```

**TypeScript**:
- å¯ç”¨ä¸¥æ ¼æ¨¡å¼ - æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡ç±»å‹æ£€æŸ¥
- é¿å…ä½¿ç”¨ `any` ç±»å‹ï¼ˆESLint å¼ºåˆ¶è­¦å‘Šï¼‰
- ä¸ºæ‰€æœ‰å‡½æ•°å’Œå˜é‡ä½¿ç”¨é€‚å½“çš„ç±»å‹å®šä¹‰

### æµ‹è¯•è§„èŒƒ

- ä½¿ç”¨ Jest å’Œ ts-jest é¢„è®¾
- åœ¨æµ‹è¯•ä¸­æ¨¡æ‹Ÿ Electron æ¨¡å—ï¼ˆå‚è€ƒ `tests/utils/setup.ts`ï¼‰
- æµ‹è¯•æ–‡ä»¶: `*.test.ts` æˆ– `*.spec.ts`
- ä¸ºæå‡æ€§èƒ½ï¼Œè¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶: `jest path/to/test.test.ts`
- ä»£ç æ›´æ”¹åï¼Œè¿è¡Œç±»å‹æ£€æŸ¥å’Œæµ‹è¯•

## è·¯å¾„åˆ«å

TypeScript è·¯å¾„åˆ«åé…ç½®åœ¨ `tsconfig.json`:
- `@/*`: æ˜ å°„åˆ° `src/*`
- `@/main/*`: æ˜ å°„åˆ° `src/main/*`
- `@/renderer/*`: æ˜ å°„åˆ° `src/renderer/*`
- `@/shared/*`: æ˜ å°„åˆ° `src/shared/*`

Webpack é…ç½®å¿…é¡»é•œåƒè¿™äº›åˆ«åã€‚

## æ„å»ºç³»ç»Ÿ

ä¸‰ä¸ªç‹¬ç«‹çš„ webpack é…ç½®ï¼š
- `config/webpack.main.config.js`: ä¸»è¿›ç¨‹ï¼ˆtarget: electron-mainï¼‰
- `config/webpack.renderer.config.js`: æ¸²æŸ“è¿›ç¨‹ï¼ˆtarget: electron-rendererï¼Œå¼€å‘æœåŠ¡å™¨ï¼‰
- `config/webpack.preload.config.js`: é¢„åŠ è½½è„šæœ¬ï¼ˆtarget: electron-preloadï¼‰

æ‰€æœ‰é…ç½®éƒ½ä½¿ç”¨ ts-loader è¿›è¡Œ TypeScript ç¼–è¯‘ã€‚

## æ–‡æ¡£

`/docs` ä¸­çš„æ ¸å¿ƒæ¶æ„æ–‡æ¡£ï¼š
- `00-global-requirements-v1.0.0.md`: å…¨å±€è¦æ±‚å’Œçº¦æŸ
- `01-architecture-design-v1.0.0.md`: ç³»ç»Ÿæ¶æ„
- `02-technical-blueprint-v1.0.0.md`: æŠ€æœ¯å®ç°ç»†èŠ‚
- `04-initialization-guidelines-v1.0.0.md`: è®¾ç½®å’Œåˆå§‹åŒ–
- `05-project-structure-v1.0.1.md`: ç›®å½•ç»“æ„
- `06-core-services-design-v1.0.1.md`: æœåŠ¡å±‚è®¾è®¡

å‚è€ƒ UI è®¾è®¡: `docs/references/UI/matrix`

## å¼€å‘å·¥ä½œæµ

1. ä¿®æ”¹å‰åŠ¡å¿…å…ˆé˜…è¯»ç›¸å…³æ–‡ä»¶
2. ä»£ç ä¿®æ”¹åè¿è¡Œç±»å‹æ£€æŸ¥: `npm run lint`
3. å¯¹å—å½±å“çš„åŒºåŸŸè¿è¡Œæµ‹è¯•ï¼ˆä¸ºæå‡é€Ÿåº¦ï¼Œä¼˜å…ˆè¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶ï¼‰
4. éµå¾ªç°æœ‰çš„ä»£ç æ¨¡å¼å’ŒæœåŠ¡ç»“æ„
5. æ·»åŠ æ–°åŠŸèƒ½æ—¶æ›´æ–°æµ‹è¯•
6. æ·»åŠ æ–°çš„ä¸»è¿›ç¨‹-æ¸²æŸ“è¿›ç¨‹é€šä¿¡æ—¶æ£€æŸ¥ IPC å¤„ç†å™¨

## æ³¨æ„äº‹é¡¹

- **æœåŠ¡å®ç°çŠ¶æ€** (v0.2.0):
  - å®Œæ•´å®ç°: ProjectManagerã€AssetManagerã€TimeServiceã€Loggerã€ServiceErrorHandler (5/8)
  - MVPå®ç°: PluginManagerã€TaskSchedulerã€APIManager (3/8) - åŸºç¡€åŠŸèƒ½å¯ç”¨ï¼Œé«˜çº§ç‰¹æ€§å¾…å®Œå–„
- **IPCå¤„ç†å™¨çŠ¶æ€**:
  - å®Œæ•´å®ç°: 51ä¸ªå¤„ç†å™¨ (åº”ç”¨ã€çª—å£ã€é¡¹ç›®ã€èµ„äº§ã€æ–‡ä»¶ç³»ç»Ÿ)
  - éƒ¨åˆ†å®ç°: 20ä¸ªå¤„ç†å™¨ (å·¥ä½œæµã€æ’ä»¶ã€ä»»åŠ¡ã€API)
  - æ¨¡æ‹Ÿå®ç°: 9ä¸ªå¤„ç†å™¨ (MCPå’ŒlocalæœåŠ¡) - å¾…åç»­çœŸå®é›†æˆ
- **UIå®ç°çŠ¶æ€**:
  - é€šç”¨ç»„ä»¶: 10/10 å®Œæ•´å®ç° (Button, Card, Modal, Toast, Loadingç­‰)
  - é¡µé¢åŠŸèƒ½: Dashboardå®Œæ•´ï¼Œå…¶ä»–é¡µé¢ä¸ºåŸºç¡€æ¡†æ¶
- **æŠ€æœ¯è§„èŒƒ**:
  - UI éµå¾ª V14 è®¾è®¡ç³»ç»Ÿï¼Œä½¿ç”¨åŸå­åŒ–ç»„ä»¶
  - React ç»„ä»¶ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶å’Œ Hooks (æœªä½¿ç”¨Redux)
  - è·¯ç”±åŒ…è£…åœ¨ Layout ç»„ä»¶ä¸­ä»¥ä¿æŒå¯¼èˆªä¸€è‡´æ€§
